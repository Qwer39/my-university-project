<!DOCTYPE html>
<html lang="ru" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–Ω—Ç–∞–∫—Ç—ã - –ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ</title>
    <link rel="stylesheet" href="../styles/styles.css">
</head>
<body>
    <div class="page-container">
        <header class="header">
            <button class="theme-toggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô</button>
            <h1 class="header__title">–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ —Å—Ç—É–¥–µ–Ω—Ç–∞</h1>
            <p class="header__subtitle">–°–µ–º–µ—Å—Ç—Ä–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</p>
        </header>

        <nav class="nav" aria-label="–û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è">
            <ul class="nav__list">
                <li class="nav__item">
                    <a class="nav__link" href="../index.html">–ì–ª–∞–≤–Ω–∞—è</a>
                </li>
                <li class="nav__item">
                    <a class="nav__link" href="news.html">–ù–æ–≤–æ—Å—Ç–∏</a>
                </li>
                <li class="nav__item">
                    <a class="nav__link" href="practices.html">–ü—Ä–∞–∫—Ç–∏–∫–∏</a>
                </li>
                <li class="nav__item">
                    <a class="nav__link" href="goods.html">–¢–æ–≤–∞—Ä—ã</a>
                </li>
                <li class="nav__item">
                    <a class="nav__link nav__link--active" href="contacts.html" 
                    aria-current="page">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
                </li>
            </ul>
        </nav>

        <main class="main">
            <section class="contacts">
                <h1 class="contacts__title">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h1>
                
                <div class="contact-info">
                    <div class="contact-info__item">
                        <span class="contact-info__label">–ê–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã:</span>
                        <span>astafiev@mirea.ru</span>
                    </div>
                    <div class="contact-info__item">
                        <span class="contact-info__label">–¢–µ–ª–µ—Ñ–æ–Ω:</span>
                        <span>+7 (495) 123-45-67</span>
                    </div>
                    <div class="contact-info__item">
                        <span class="contact-info__label">–ê–¥—Ä–µ—Å:</span>
                        <span>–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. –ö–æ–ª–æ—Ç—É—à–∫–∏–Ω–∞</span>
                    </div>
                </div>

                <div class="contact-grid">
                    <div class="contact-item">
                        <h3 class="contact-item__title">–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã</h3>
                        <p class="contact-item__value">–ü–Ω-–ü—Ç: 9:00-18:00</p>
                    </div>
                    <div class="contact-item">
                        <h3 class="contact-item__title">–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</h3>
                        <p class="contact-item__value">VK, Telegram, WhatsApp</p>
                    </div>
                </div>

                <button class="button" onclick="openModal()">
                    –°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏
                </button>
            </section>
        </main>

        <footer class="footer">
            <p>&copy; 2024 –°–µ–º–µ—Å—Ç—Ä–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </footer>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
        <dialog id="contactModal" class="modal" 
                role="dialog" 
                aria-modal="true"
                aria-labelledby="modal-title"
                aria-describedby="modal-description">
            
            <div class="modal__header">
                <h2 id="modal-title" class="modal__title">–§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏</h2>
                <p id="modal-description" class="modal__description">
                    –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –Ω–∏–∂–µ, –∏ –º—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è
                </p>
                <button class="modal__close" 
                        onclick="closeModal()" 
                        aria-label="–ó–∞–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ">
                    <span aria-hidden="true">√ó</span>
                    <span class="sr-only">–ó–∞–∫—Ä—ã—Ç—å</span>
                </button>
            </div>
            <div class="modal__content">
                <form id="feedbackForm" method="dialog" class="form" novalidate>
                    
                    <!-- –î–û–ë–ê–í–¨–¢–ï fieldset –î–õ–Ø –ö–û–ù–¢–ê–ö–¢–ù–û–ô –ò–ù–§–û–†–ú–ê–¶–ò–ò -->
                    <fieldset class="form__fieldset">
                        <legend class="form__legend">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</legend>
                        
                        <!-- –ü–æ–ª–µ –∏–º–µ–Ω–∏ - –û–ë–ù–û–í–ò–¢–ï –°–£–©–ï–°–¢–í–£–Æ–©–ï–ï -->
                        <div class="form__group">
                            <label for="name" class="form__label">
                                –ò–º—è <span class="form__required" aria-hidden="true">*</span>
                                <span class="sr-only">–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</span>
                            </label>
                            <input type="text" id="name" name="name" class="form__input" 
                                required aria-required="true"
                                placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" minlength="2"
                                aria-describedby="name-error"
                                autofocus>
                            <div id="name-error" class="form__error" role="alert" aria-live="polite"></div>
                        </div>

                        <!-- –ü–æ–ª–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ - –û–ë–ù–û–í–ò–¢–ï –°–£–©–ï–°–¢–í–£–Æ–©–ï–ï -->
                        <div class="form__group">
                            <label for="phone" class="form__label">
                                –¢–µ–ª–µ—Ñ–æ–Ω <span class="form__required" aria-hidden="true">*</span>
                                <span class="sr-only">–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</span>
                            </label>
                            <input type="tel" id="phone" name="phone" class="form__input" 
                                required aria-required="true"
                                placeholder="+7 (XXX) XXX-XX-XX" 
                                pattern="^\+7 \(\d{3}\) \d{3}-\d{2}-\d{2}$"
                                aria-describedby="phone-error">
                            <div id="phone-error" class="form__error" role="alert" aria-live="polite"></div>
                        </div>

                        <!-- –ü–æ–ª–µ email - –û–ë–ù–û–í–ò–¢–ï –°–£–©–ï–°–¢–í–£–Æ–©–ï–ï -->
                        <div class="form__group">
                            <label for="email" class="form__label">
                                –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞ <span class="form__required" aria-hidden="true">*</span>
                                <span class="sr-only">–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</span>
                            </label>
                            <input type="email" id="email" name="email" class="form__input" 
                                required aria-required="true"
                                placeholder="example@mail.ru"
                                aria-describedby="email-error">
                            <div id="email-error" class="form__error" role="alert" aria-live="polite"></div>
                        </div>
                    </fieldset>

                    <!-- –î–û–ë–ê–í–¨–¢–ï fieldset –î–õ–Ø –ö–ê–¢–ï–ì–û–†–ò–ò -->
                    <fieldset class="form__fieldset">
                        <legend class="form__legend">
                            –¢–∏–ø –æ–±—Ä–∞—â–µ–Ω–∏—è <span class="form__required" aria-hidden="true">*</span>
                        </legend>
                        
                        <div class="form__group">
                            <label for="category" class="form__label sr-only">
                                –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –æ–±—Ä–∞—â–µ–Ω–∏—è
                            </label>
                            <select id="category" name="category" class="form__select" 
                                    required aria-required="true"
                                    aria-describedby="category-error">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                                <option value="technical">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</option>
                                <option value="commercial">–ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</option>
                                <option value="cooperation">–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ</option>
                                <option value="complaint">–ñ–∞–ª–æ–±–∞</option>
                                <option value="suggestion">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</option>
                                <option value="other">–î—Ä—É–≥–æ–µ</option>
                            </select>
                            <div id="category-error" class="form__error" role="alert" aria-live="polite"></div>
                        </div>
                    </fieldset>

                    <!-- –ü–æ–ª–µ —Å–æ–æ–±—â–µ–Ω–∏—è - –û–ë–ù–û–í–ò–¢–ï –°–£–©–ï–°–¢–í–£–Æ–©–ï–ï -->
                    <div class="form__group">
                        <label for="message" class="form__label">
                            –¢–µ–∫—Å—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è <span class="form__required" aria-hidden="true">*</span>
                            <span class="sr-only">–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</span>
                        </label>
                        <textarea id="message" name="message" class="form__textarea" 
                                required aria-required="true"
                                placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É –∏–ª–∏ –≤–æ–ø—Ä–æ—Å..."
                                aria-describedby="message-error"></textarea>
                        <div id="message-error" class="form__error" role="alert" aria-live="polite"></div>
                    </div>

                    <!-- –ö–ù–û–ü–ö–ò –û–°–¢–ê–í–¨–¢–ï –ö–ê–ö –ï–°–¢–¨ -->
                    <div class="form__actions">
                        <button type="button" class="button button--secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
                        <button type="button" class="button" onclick="submitForm()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                </form>
            </div>
        </dialog>
    </div>

    <script src="../scripts/theme.js"></script>
    <script>
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–æ–∫—É—Å–æ–º
        let previousActiveElement;

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function openModal() {
            const modal = document.getElementById('contactModal');
            previousActiveElement = document.activeElement;
            
            modal.showModal();
            
            // –°–∫—Ä—ã—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç –æ—Ç —Å–∫—Ä–∏–Ω—Ä–∏–¥–µ—Ä–∞
            document.querySelectorAll('main, footer, .header')
                .forEach(el => el.setAttribute('aria-hidden', 'true'));
            
            // –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ Escape
            document.addEventListener('keydown', handleEscape);
        }

        function closeModal() {
            const modal = document.getElementById('contactModal');
            modal.close();
            
            // –í–µ—Ä–Ω—É—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç—É
            document.querySelectorAll('[aria-hidden="true"]')
                .forEach(el => el.removeAttribute('aria-hidden'));
            
            // –í–µ—Ä–Ω—É—Ç—å —Ñ–æ–∫—É—Å
            if (previousActiveElement) previousActiveElement.focus();
            
            document.removeEventListener('keydown', handleEscape);
        }

        function handleEscape(event) {
            if (event.key === 'Escape') {
                closeModal();
            }
        }

        // –ó–∞—Ö–≤–∞—Ç —Ñ–æ–∫—É—Å–∞ –≤–Ω—É—Ç—Ä–∏ –º–æ–¥–∞–ª–∫–∏
        document.getElementById('contactModal').addEventListener('keydown', function(event) {
            if (event.key === 'Tab') {
                const focusableElements = this.querySelectorAll(
                    'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
                );
                
                if (focusableElements.length === 0) return;
                
                const firstElement = focusableElements[0];
                const lastElement = focusableElements[focusableElements.length - 1];
                
                if (event.shiftKey && document.activeElement === firstElement) {
                    event.preventDefault();
                    lastElement.focus();
                } else if (!event.shiftKey && document.activeElement === lastElement) {
                    event.preventDefault();
                    firstElement.focus();
                }
            }
        });

        // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º
        function validateField(field) {
            const errorElement = document.getElementById(field.id + '-error');
            
            if (!field.checkValidity()) {
                field.setAttribute('aria-invalid', 'true');
                errorElement.textContent = getErrorMessage(field);
                return false;
            } else {
                field.setAttribute('aria-invalid', 'false');
                errorElement.textContent = '';
                return true;
            }
        }

        function getErrorMessage(field) {
            if (field.validity.valueMissing) {
                return '–≠—Ç–æ –ø–æ–ª–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è';
            }
            if (field.validity.tooShort) {
                return `–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: ${field.minLength} —Å–∏–º–≤–æ–ª–æ–≤`;
            }
            if (field.validity.typeMismatch) {
                return '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ';
            }
            if (field.validity.patternMismatch) {
                return '–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ';
            }
            return '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø—Ä–∞–≤—å—Ç–µ —ç—Ç–æ –ø–æ–ª–µ';
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
        function submitForm() {
            const form = document.getElementById('feedbackForm');
            const fields = form.querySelectorAll('input, select, textarea');
            let isValid = true;

            // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
            fields.forEach(field => {
                if (!validateField(field)) {
                    isValid = false;
                }
            });

            if (!isValid) {
                // –°—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–º –æ—à–∏–±–æ—á–Ω–æ–º –ø–æ–ª–µ
                const firstError = form.querySelector('[aria-invalid="true"]');
                if (firstError) {
                    firstError.focus();
                }
                return;
            }

            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã (–≤–∞—à —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥)
            const formData = new FormData(form);
            const data = Object.fromEntries(formData);
            console.log('–î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã:', data);

            alert('–°–ø–∞—Å–∏–±–æ! –í–∞—à–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ. –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.');
            closeModal();
            form.reset();
        }

        // –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–∞ –ø–æ–ª—è
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('feedbackForm');
            if (form) {
                const fields = form.querySelectorAll('input, select, textarea');
                fields.forEach(field => {
                    field.addEventListener('blur', () => validateField(field));
                    field.addEventListener('input', () => {
                        if (field.hasAttribute('aria-invalid')) {
                            validateField(field);
                        }
                    });
                });
            }
        });

        // –ú–∞—Å–∫–∞ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–≤–∞—à —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥)
        document.getElementById('phone')?.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.startsWith('7') || value.startsWith('8')) {
                value = value.substring(1);
            }
            value = value.substring(0, 10);
            
            let formattedValue = '+7 (';
            if (value.length > 0) formattedValue += value.substring(0, 3);
            if (value.length >= 4) formattedValue += ') ' + value.substring(3, 6);
            if (value.length >= 7) formattedValue += '-' + value.substring(6, 8);
            if (value.length >= 9) formattedValue += '-' + value.substring(8, 10);
            
            e.target.value = formattedValue;
        });

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        document.getElementById('contactModal').addEventListener('click', function(event) {
            if (event.target === this) {
                closeModal();
            }
        });
    </script>
</body>
</html>